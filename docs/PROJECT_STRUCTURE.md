# é¡¹ç›®ç»“æ„è¯´æ˜

## ğŸ“ ç›®å½•ç»„ç»‡

```
AI-Narrated-Recap-Analyst/
â”‚
â”œâ”€â”€ docs/                           # ğŸ“š æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ PROJECT_STRUCTURE.md        # é¡¹ç›®ç»“æ„è¯´æ˜ï¼ˆæœ¬æ–‡ä»¶ï¼‰
â”‚   â”œâ”€â”€ DEV_STANDARDS.md            # å¼€å‘æ ‡å‡†ä¸è§„èŒƒ
â”‚   â”œâ”€â”€ FILE_PATH_MAPPING.md        # æ–‡ä»¶è·¯å¾„æ˜ å°„è¯´æ˜
â”‚   â”œâ”€â”€ FRONTEND_INTEGRATION_COMPLETE.md  # å‰ç«¯é›†æˆå®Œæˆæ–‡æ¡£
â”‚   â”œâ”€â”€ README.md                   # æ–‡æ¡£ç´¢å¼•
â”‚   â”‚
â”‚   â”œâ”€â”€ architecture/               # æ¶æ„è®¾è®¡æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ AUTO_PREPROCESS_IMPLEMENTATION.md  # è‡ªåŠ¨é¢„å¤„ç†å®ç°
â”‚   â”‚   â”œâ”€â”€ DATA_STORAGE_REDESIGN.md          # æ•°æ®å­˜å‚¨é‡æ–°è®¾è®¡
â”‚   â”‚   â””â”€â”€ REDESIGN_PROGRESS.md              # é‡æ–°è®¾è®¡è¿›åº¦
â”‚   â”‚
â”‚   â”œâ”€â”€ core/                       # Coreæ¨¡å—æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ README.md
â”‚   â”‚   â”œâ”€â”€ DUAL_LLM_SETUP.md       # åŒLLMé…ç½®è¯´æ˜
â”‚   â”‚   â”œâ”€â”€ LLM_INTEGRATION_GUIDE.md
â”‚   â”‚   â”œâ”€â”€ LLM_RATE_LIMIT_SYSTEM.md
â”‚   â”‚   â”œâ”€â”€ LLM_SYSTEM_COMPLETE.md
â”‚   â”‚   â””â”€â”€ README_LLM_SYSTEM.md
â”‚   â”‚
â”‚   â”œâ”€â”€ tools/                      # Toolsæ¨¡å—æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ README.md
â”‚   â”‚   â”œâ”€â”€ ROADMAP.md              # å·¥å…·è·¯çº¿å›¾
â”‚   â”‚   â”œâ”€â”€ functional_tags.md
â”‚   â”‚   â”œâ”€â”€ FUNCTIONAL_TAGS_UPDATE.md
â”‚   â”‚   â”œâ”€â”€ novel_*.md              # å°è¯´ç›¸å…³å·¥å…·æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ script_*.md             # è„šæœ¬ç›¸å…³å·¥å…·æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ srt_*.md                # SRTç›¸å…³å·¥å…·æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ hook_*.md               # Hookç›¸å…³å·¥å…·æ–‡æ¡£
â”‚   â”‚   â””â”€â”€ system_*.md             # ç³»ç»Ÿç›¸å…³æ–‡æ¡£
â”‚   â”‚
â”‚   â”œâ”€â”€ workflows/                  # Workflowsæ¨¡å—æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ README.md
â”‚   â”‚   â”œâ”€â”€ ROADMAP.md
â”‚   â”‚   â”œâ”€â”€ novel_processing_workflow.md
â”‚   â”‚   â”œâ”€â”€ script_processing_workflow.md
â”‚   â”‚   â”œâ”€â”€ QUALITY_STANDARDS.md
â”‚   â”‚   â”œâ”€â”€ RETRY_MECHANISM.md
â”‚   â”‚   â”œâ”€â”€ BUGFIX_SUMMARY.md
â”‚   â”‚   â””â”€â”€ LLM_ASYNC_FIX.md
â”‚   â”‚
â”‚   â”œâ”€â”€ ui/                         # å‰ç«¯UIæ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ README.md
â”‚   â”‚   â”œâ”€â”€ UI_ARCHITECTURE.md
â”‚   â”‚   â”œâ”€â”€ UI_DESIGN_GEEK_STYLE.md
â”‚   â”‚   â”œâ”€â”€ API_SPECIFICATION.md
â”‚   â”‚   â”œâ”€â”€ QUICKSTART.md
â”‚   â”‚   â”œâ”€â”€ IMPLEMENTATION_PLAN.md
â”‚   â”‚   â”œâ”€â”€ SHADCN_IMPLEMENTATION_SUMMARY.md
â”‚   â”‚   â”œâ”€â”€ UI_SYSTEM_SUMMARY.md
â”‚   â”‚   â””â”€â”€ DOCKER_DEPLOYMENT.md
â”‚   â”‚
â”‚   â”œâ”€â”€ maintenance/                # ç»´æŠ¤æ€§æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ DOC_CODE_CONSISTENCY_REPORT.md
â”‚   â”‚   â”œâ”€â”€ DOC_UPDATE_SUMMARY_2026-02-10.md
â”‚   â”‚   â”œâ”€â”€ IMPROVEMENT_SUMMARY_2026-02-10.md
â”‚   â”‚   â”œâ”€â”€ INTEGRATION_SUMMARY.md
â”‚   â”‚   â”œâ”€â”€ LLM_SYSTEM_OVERVIEW.md
â”‚   â”‚   â”œâ”€â”€ MIGRATION_SUMMARY.md
â”‚   â”‚   â”œâ”€â”€ PROJECT_HEALTH_CHECK_2026-02-10.md
â”‚   â”‚   â”œâ”€â”€ TOOL_APPLICATION_SUMMARY_2026-02-10.md
â”‚   â”‚   â””â”€â”€ WORKFLOW_SPLIT_SUMMARY_2026-02-10.md
â”‚   â”‚
â”‚   â””â”€â”€ archive/                    # å½’æ¡£æ–‡æ¡£
â”‚       â””â”€â”€ docs/                   # æ—§ç‰ˆæœ¬æ–‡æ¡£
â”‚
â”œâ”€â”€ src/                            # ğŸ’» æºä»£ç 
â”‚   â”œâ”€â”€ api/                        # FastAPIåç«¯æœåŠ¡ â­
â”‚   â”‚   â”œâ”€â”€ main.py                 # APIå…¥å£
â”‚   â”‚   â”œâ”€â”€ routes/                 # APIè·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ projects.py         # é¡¹ç›®ç®¡ç†APIï¼ˆV1ï¼Œå·²åºŸå¼ƒï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ projects_v2.py      # é¡¹ç›®ç®¡ç†APIï¼ˆV2ï¼Œæ¨èï¼‰â­
â”‚   â”‚   â”‚   â””â”€â”€ workflows.py        # å·¥ä½œæµAPI
â”‚   â”‚   â”œâ”€â”€ schemas/                # APIæ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ projects.py
â”‚   â”‚   â”‚   â”œâ”€â”€ projects_v2.py
â”‚   â”‚   â”‚   â””â”€â”€ workflows.py
â”‚   â”‚   â”œâ”€â”€ services/               # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”‚   â””â”€â”€ middleware/             # ä¸­é—´ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ core/                       # æ ¸å¿ƒç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ interfaces.py           # æ¥å£å®šä¹‰ï¼ˆBaseTool, BaseAgent, BaseWorkflowï¼‰
â”‚   â”‚   â”œâ”€â”€ config.py               # é…ç½®ç®¡ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ schemas_novel/          # å°è¯´ç›¸å…³æ•°æ®æ¨¡å‹ï¼ˆå·²æ‹†åˆ†ï¼‰â­
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ basic.py            # åŸºç¡€æ•°æ®ç»“æ„ï¼ˆChapter, Paragraphç­‰ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ segmentation.py     # åˆ†æ®µç›¸å…³ï¼ˆSegmentedChapterç­‰ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ annotation.py       # æ ‡æ³¨ç›¸å…³ï¼ˆAnnotatedChapter, EventTimelineç­‰ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ system.py           # ç³»ç»Ÿå…ƒç´ ç›¸å…³ï¼ˆSystemCatalogç­‰ï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ validation.py       # éªŒè¯ç›¸å…³ï¼ˆValidationResultç­‰ï¼‰
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ schemas_script.py       # è„šæœ¬ç›¸å…³æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ schemas_alignment.py    # å¯¹é½ç›¸å…³æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ schemas_project.py      # é¡¹ç›®ç›¸å…³æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ schemas.py              # é€šç”¨æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ project_manager.py      # é¡¹ç›®ç®¡ç†ï¼ˆV1ï¼Œå·²å¼ƒç”¨ï¼‰âŒ
â”‚   â”‚   â”œâ”€â”€ project_manager_v2.py   # é¡¹ç›®ç®¡ç†ï¼ˆV2ï¼Œå½“å‰ä½¿ç”¨ï¼‰âœ…â­
â”‚   â”‚   â”œâ”€â”€ llm_rate_limiter.py     # LLMé€Ÿç‡é™åˆ¶
â”‚   â”‚   â”œâ”€â”€ two_pass_tool.py        # Two-Passå·¥å…·åŸºç±»
â”‚   â”‚   â””â”€â”€ exceptions.py           # å¼‚å¸¸å®šä¹‰
â”‚   â”‚
â”‚   â”œâ”€â”€ tools/                      # ç‹¬ç«‹å·¥å…·åº“ï¼ˆæ— çŠ¶æ€ï¼‰
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ novel_importer.py       # å°è¯´å¯¼å…¥
â”‚   â”‚   â”œâ”€â”€ novel_metadata_extractor.py  # å…ƒæ•°æ®æå–
â”‚   â”‚   â”œâ”€â”€ novel_chapter_detector.py    # ç« èŠ‚æ£€æµ‹
â”‚   â”‚   â”œâ”€â”€ novel_segmenter.py      # å°è¯´åˆ†æ®µï¼ˆTwo-Passï¼‰â­
â”‚   â”‚   â”œâ”€â”€ novel_annotator.py      # å°è¯´æ ‡æ³¨ï¼ˆTwo-Passï¼‰â­
â”‚   â”‚   â”œâ”€â”€ novel_tagger.py         # åŠŸèƒ½æ ‡ç­¾ç”Ÿæˆ
â”‚   â”‚   â”œâ”€â”€ novel_validator.py      # å°è¯´éªŒè¯
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ novel_system_detector.py     # ç³»ç»Ÿå…ƒç´ æ£€æµ‹ â­
â”‚   â”‚   â”œâ”€â”€ novel_system_analyzer.py     # ç³»ç»Ÿå…ƒç´ åˆ†æ
â”‚   â”‚   â”œâ”€â”€ novel_system_tracker.py      # ç³»ç»Ÿå…ƒç´ è¿½è¸ª
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ srt_importer.py         # SRTå¯¼å…¥
â”‚   â”‚   â”œâ”€â”€ srt_text_extractor.py   # SRTæ–‡æœ¬æå–
â”‚   â”‚   â”œâ”€â”€ script_segmenter.py     # è„šæœ¬åˆ†æ®µï¼ˆTwo-Passï¼‰â­
â”‚   â”‚   â”œâ”€â”€ script_validator.py     # è„šæœ¬éªŒè¯
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ novel_script_aligner.py # å°è¯´-è„šæœ¬å¯¹é½
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ hook_detector.py        # Hookæ£€æµ‹
â”‚   â”‚   â””â”€â”€ hook_content_analyzer.py # Hookåˆ†æ
â”‚   â”‚
â”‚   â”œâ”€â”€ workflows/                  # å·¥ä½œæµç¼–æ’
â”‚   â”‚   â”œâ”€â”€ novel_processing_workflow.py   # å°è¯´å¤„ç†å·¥ä½œæµ
â”‚   â”‚   â”œâ”€â”€ script_processing_workflow.py  # è„šæœ¬å¤„ç†å·¥ä½œæµ
â”‚   â”‚   â”œâ”€â”€ preprocess_service.py          # é¢„å¤„ç†æœåŠ¡ï¼ˆåå°ä»»åŠ¡ï¼‰â­
â”‚   â”‚   â”œâ”€â”€ report_generator.py            # æŠ¥å‘Šç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ training_workflow_v2.py        # è®­ç»ƒå·¥ä½œæµV2
â”‚   â”‚
â”‚   â”œâ”€â”€ prompts/                    # ğŸ¯ æç¤ºè¯ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ novel_chapter_segmentation_pass1.yaml  # å°è¯´åˆ†æ®µPass1 â­
â”‚   â”‚   â”œâ”€â”€ novel_chapter_segmentation_pass2.yaml  # å°è¯´åˆ†æ®µPass2 â­
â”‚   â”‚   â”œâ”€â”€ novel_annotation_pass1.yaml            # å°è¯´æ ‡æ³¨Pass1
â”‚   â”‚   â”œâ”€â”€ novel_annotation_pass2.yaml            # å°è¯´æ ‡æ³¨Pass2
â”‚   â”‚   â”œâ”€â”€ novel_annotation_pass3_functional_tags.yaml  # åŠŸèƒ½æ ‡ç­¾Pass3
â”‚   â”‚   â”œâ”€â”€ novel_tagging.yaml
â”‚   â”‚   â”œâ”€â”€ novel_system_detection.yaml
â”‚   â”‚   â”œâ”€â”€ novel_system_analysis.yaml
â”‚   â”‚   â”œâ”€â”€ novel_system_tracking.yaml
â”‚   â”‚   â”œâ”€â”€ novel_system_templates.yaml
â”‚   â”‚   â”œâ”€â”€ novel_script_alignment.yaml
â”‚   â”‚   â”œâ”€â”€ script_segmentation_abc_classification.yaml  # è„šæœ¬åˆ†æ®µABCåˆ†ç±»
â”‚   â”‚   â”œâ”€â”€ hook_detection.yaml
â”‚   â”‚   â””â”€â”€ hook_content_analysis.yaml
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                      # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ llm_output_parser.py    # LLMè¾“å‡ºè§£æ
â”‚   â”‚   â””â”€â”€ novel_helpers.py        # å°è¯´å¤„ç†è¾…åŠ©å‡½æ•°
â”‚   â”‚
â”‚   â””â”€â”€ agents/                     # AI Agentå®ç°ï¼ˆé¢„ç•™ï¼‰
â”‚
â”œâ”€â”€ frontend-new/                   # ğŸ¨ å‰ç«¯é¡¹ç›®ï¼ˆå½“å‰ä½¿ç”¨ï¼‰â­
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/             # UIç»„ä»¶ï¼ˆshadcn UIï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/                 # shadcnåŸºç¡€ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ app-sidebar.tsx     # åº”ç”¨ä¾§è¾¹æ 
â”‚   â”‚   â”‚   â”œâ”€â”€ site-header.tsx     # ç«™ç‚¹å¤´éƒ¨
â”‚   â”‚   â”‚   â”œâ”€â”€ chart-area-interactive.tsx  # äº¤äº’å¼å›¾è¡¨
â”‚   â”‚   â”‚   â”œâ”€â”€ data-table.tsx      # æ•°æ®è¡¨æ ¼
â”‚   â”‚   â”‚   â””â”€â”€ layout/             # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ pages/                  # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx               # é¡¹ç›®åˆ—è¡¨
â”‚   â”‚   â”‚   â”œâ”€â”€ ProjectDetailPage.tsx      # é¡¹ç›®è¯¦æƒ… â­
â”‚   â”‚   â”‚   â”œâ”€â”€ NovelViewerPage.tsx        # å°è¯´æŸ¥çœ‹å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ ScriptViewerPage.tsx       # è„šæœ¬æŸ¥çœ‹å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ WorkflowPage.tsx           # å·¥ä½œæµé¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ SettingsPage.tsx           # è®¾ç½®é¡µé¢
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ api/                    # APIå®¢æˆ·ç«¯
â”‚   â”‚   â”‚   â”œâ”€â”€ projectsV2.ts       # V2é¡¹ç›®API â­
â”‚   â”‚   â”‚   â””â”€â”€ workflows.ts        # å·¥ä½œæµAPI
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ types/                  # TypeScriptç±»å‹å®šä¹‰
â”‚   â”‚   â”‚   â””â”€â”€ project.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ lib/                    # å·¥å…·åº“
â”‚   â”‚   â”‚   â”œâ”€â”€ queryClient.ts      # React Queryé…ç½®
â”‚   â”‚   â”‚   â””â”€â”€ utils.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ store/                  # çŠ¶æ€ç®¡ç†ï¼ˆZustandï¼‰
â”‚   â”‚   â”œâ”€â”€ hooks/                  # è‡ªå®šä¹‰Hooks
â”‚   â”‚   â”œâ”€â”€ App.tsx                 # åº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ main.tsx                # ä¸»å…¥å£
â”‚   â”‚   â””â”€â”€ index.css               # å…¨å±€æ ·å¼
â”‚   â”‚
â”‚   â”œâ”€â”€ public/                     # é™æ€èµ„æº
â”‚   â”œâ”€â”€ components.json             # shadcné…ç½®
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ scripts/                        # ğŸ”§ è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ test/                       # æµ‹è¯•è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ test_novel_*.py         # å°è¯´ç›¸å…³æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_script_*.py        # è„šæœ¬ç›¸å…³æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_llm_*.py           # LLMç›¸å…³æµ‹è¯•
â”‚   â”‚   â””â”€â”€ test_*.py               # å…¶ä»–æµ‹è¯•
â”‚   â”‚
â”‚   â”œâ”€â”€ ui/                         # UIç›¸å…³è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ init_ui_project.sh
â”‚   â”‚   â””â”€â”€ start_backend.sh
â”‚   â”‚
â”‚   â”œâ”€â”€ setup_claude.sh
â”‚   â”œâ”€â”€ test_resume.sh
â”‚   â”œâ”€â”€ migrate_raw_to_categories.py
â”‚   â””â”€â”€ split_*.py
â”‚
â”œâ”€â”€ data/                           # ğŸ“¦ æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ project_index.json          # é¡¹ç›®ç´¢å¼•
â”‚   â””â”€â”€ projects/                   # å„é¡¹ç›®æ•°æ®
â”‚       â””â”€â”€ project_XXX/
â”‚           â”œâ”€â”€ meta.json           # é¡¹ç›®å…ƒæ•°æ®
â”‚           â”œâ”€â”€ raw/                # åŸå§‹æ•°æ®ï¼ˆç”¨æˆ·ä¸Šä¼ ï¼‰
â”‚           â”‚   â”œâ”€â”€ novel/          # å°è¯´åŸå§‹æ–‡ä»¶
â”‚           â”‚   â””â”€â”€ script/         # è„šæœ¬åŸå§‹æ–‡ä»¶ï¼ˆ.srtï¼‰âš ï¸ ä»srt/æ”¹å
â”‚           â”‚
â”‚           â””â”€â”€ analyst/            # âœ¨ Phase I Analyst å·¥ä½œæµæ•°æ®
â”‚               â”œâ”€â”€ import/         # Step 1: å¯¼å…¥ä¸æ ‡å‡†åŒ–
â”‚               â”‚   â”œâ”€â”€ novel/
â”‚               â”‚   â”‚   â”œâ”€â”€ metadata.json        # å…ƒæ•°æ®
â”‚               â”‚   â”‚   â”œâ”€â”€ chapters.json        # ç« èŠ‚åˆ—è¡¨
â”‚               â”‚   â”‚   â”œâ”€â”€ intro.md             # ç®€ä»‹
â”‚               â”‚   â”‚   â””â”€â”€ novel-imported.md    # æ ‡å‡†åŒ–å°è¯´
â”‚               â”‚   â””â”€â”€ script/
â”‚               â”‚       â”œâ”€â”€ episodes.json        # é›†æ•°ç´¢å¼•
â”‚               â”‚       â”œâ”€â”€ ep01.json            # é›†æ•°å…ƒæ•°æ®
â”‚               â”‚       â””â”€â”€ ep01-imported.md     # æ ‡å‡†åŒ–è„šæœ¬
â”‚               â”‚
â”‚               â”œâ”€â”€ script_analysis/    # Step 2: è„šæœ¬åˆ†æ
â”‚               â”‚   â”œâ”€â”€ ep01_segmentation_latest.json
â”‚               â”‚   â”œâ”€â”€ ep01_hook_latest.json
â”‚               â”‚   â””â”€â”€ history/        # å†å²ç‰ˆæœ¬
â”‚               â”‚
â”‚               â”œâ”€â”€ novel_analysis/     # Step 3: å°è¯´åˆ†æ
â”‚               â”‚   â”œâ”€â”€ chapter_001_segmentation_latest.json
â”‚               â”‚   â”œâ”€â”€ chapter_001_annotation_latest.json
â”‚               â”‚   â”œâ”€â”€ system_catalog_latest.json
â”‚               â”‚   â””â”€â”€ history/        # å†å²ç‰ˆæœ¬
â”‚               â”‚
â”‚               â””â”€â”€ alignment/          # Step 4: å¯¹é½åˆ†æ
â”‚                   â”œâ”€â”€ chapter_001_ep01_alignment_latest.json
â”‚                   â””â”€â”€ history/        # å†å²ç‰ˆæœ¬
â”‚
â”œâ”€â”€ config/                         # âš™ï¸ é…ç½®æ–‡ä»¶ç›®å½•
â”œâ”€â”€ output/                         # ğŸ“ ç³»ç»Ÿè¾“å‡º
â”‚   â””â”€â”€ operation_history.jsonl     # æ“ä½œå†å²æ—¥å¿—
â”‚
â”œâ”€â”€ templates/                      # ğŸ“‹ æ¨¡æ¿æ–‡ä»¶
â”œâ”€â”€ requirements-api.txt            # APIä¾èµ–
â”œâ”€â”€ requirements.txt                # Pythonä¾èµ–
â”œâ”€â”€ CHANGELOG.md                    # å˜æ›´æ—¥å¿—
â”œâ”€â”€ README.md                       # é¡¹ç›®è¯´æ˜
â””â”€â”€ .gitignore                      # Gitå¿½ç•¥è§„åˆ™
```

## ğŸ¯ å…³é”®æ–‡ä»¶è¯´æ˜

### åç«¯æœåŠ¡

#### APIè·¯ç”±
- **src/api/routes/projects_v2.py** â­ (æ¨èä½¿ç”¨):
  - `GET /api/v2/projects` - è·å–é¡¹ç›®åˆ—è¡¨
  - `POST /api/v2/projects` - åˆ›å»ºé¡¹ç›®
  - `GET /api/v2/projects/{id}` - è·å–é¡¹ç›®è¯¦æƒ…
  - `GET /api/v2/projects/{id}/meta` - è·å–é¡¹ç›®å…ƒæ•°æ®
  - `POST /api/v2/projects/{id}/files` - ä¸Šä¼ æ–‡ä»¶ï¼ˆæ”¯æŒè‡ªåŠ¨é¢„å¤„ç†ï¼‰
  - `GET /api/v2/projects/{id}/preprocess-status` - è·å–é¢„å¤„ç†çŠ¶æ€
  - `GET /api/v2/projects/{id}/chapters` - è·å–ç« èŠ‚åˆ—è¡¨
  - `GET /api/v2/projects/{id}/episodes` - è·å–é›†æ•°åˆ—è¡¨
  - `DELETE /api/v2/projects/{id}` - åˆ é™¤é¡¹ç›®

### å‰ç«¯åº”ç”¨

#### æ ¸å¿ƒé¡µé¢
- **frontend-new/src/pages/ProjectDetailPage.tsx**: é¡¹ç›®è¯¦æƒ…é¡µ
  - é¡¹ç›®ä¿¡æ¯å±•ç¤º
  - æ–‡ä»¶ä¸Šä¼ ï¼ˆæ”¯æŒæ‹–æ‹½ï¼‰
  - åŸå§‹æ–‡ä»¶åˆ—è¡¨
  - é¢„å¤„ç†çŠ¶æ€è¿½è¸ªï¼ˆå®æ—¶æ›´æ–°ï¼‰
  - ç« èŠ‚/é›†æ•°åˆ—è¡¨å±•ç¤º

### é…ç½®æ–‡ä»¶

- **src/core/config.py**: 
  - ç»Ÿä¸€çš„é…ç½®ç®¡ç†
  - `ProjectConfig`: é¡¹ç›®é…ç½®
  - `LLMConfig`: LLMç›¸å…³é…ç½®

### æ•°æ®æ¨¡å‹

#### Schemasæ‹†åˆ†ï¼ˆå·²æ¨¡å—åŒ–ï¼‰â­
- **src/core/schemas_novel/** (å·²æ‹†åˆ†):
  - `basic.py`: Chapter, Paragraph, NovelMetadata
  - `segmentation.py`: SegmentedChapter, SegmentationResult
  - `annotation.py`: AnnotatedChapter, EventTimeline, SettingCorrelation
  - `system.py`: SystemCatalog, SystemElement, SystemCategory
  - `validation.py`: ValidationResult, ValidationIssue

- **src/core/schemas_script.py**:
  - `Episode`: é›†æ•°ä¿¡æ¯
  - `Segment`: è„šæœ¬æ®µè½
  - `ABCSegment`: ABCåˆ†ç±»æ®µè½

- **src/core/schemas_alignment.py**:
  - `AlignmentResult`: å¯¹é½ç»“æœ
  - `AlignmentItem`: å¯¹é½é¡¹

- **src/core/schemas_project.py**:
  - `ProjectV2`: é¡¹ç›®ä¿¡æ¯
  - `ProjectSources`: æºæ–‡ä»¶ä¿¡æ¯
  - `WorkflowStages`: å·¥ä½œæµé˜¶æ®µçŠ¶æ€

### å·¥ä½œæµ

- **src/workflows/novel_processing_workflow.py**:
  - å¯¼å…¥ â†’ å…ƒæ•°æ®æå– â†’ ç« èŠ‚æ£€æµ‹ â†’ åˆ†æ®µ â†’ æ ‡æ³¨ â†’ ç³»ç»Ÿæ£€æµ‹
  
- **src/workflows/script_processing_workflow.py**:
  - å¯¼å…¥ â†’ æ–‡æœ¬æå– â†’ åˆ†æ®µ â†’ éªŒè¯

- **src/workflows/preprocess_service.py** â­:
  - è‡ªåŠ¨è¯†åˆ«æ–‡ä»¶ç±»å‹
  - å¼‚æ­¥æ‰§è¡Œé¢„å¤„ç†
  - çŠ¶æ€è¿½è¸ªå’Œé”™è¯¯å¤„ç†

### æç¤ºè¯

æ‰€æœ‰æç¤ºè¯ç»Ÿä¸€ç®¡ç†åœ¨ `src/prompts/*.yaml`ï¼Œä¾¿äºï¼š
- ç‰ˆæœ¬æ§åˆ¶
- å¿«é€Ÿè¿­ä»£
- A/Bæµ‹è¯•

**æ ¸å¿ƒPrompt**:
- `novel_chapter_segmentation_pass1.yaml` + `pass2.yaml`: Two-Passå°è¯´åˆ†æ®µ â­
- `novel_annotation_pass1.yaml` + `pass2.yaml` + `pass3_functional_tags.yaml`: å°è¯´æ ‡æ³¨
- `script_segmentation_abc_classification.yaml`: è„šæœ¬ABCåˆ†ç±»åˆ†æ®µ â­

## ğŸ” æ–‡ä»¶æŸ¥æ‰¾æŒ‡å—

### æƒ³è¦ä¿®æ”¹...

| éœ€æ±‚ | æŸ¥çœ‹æ–‡ä»¶ |
|------|---------|
| **LLMé…ç½®** | `src/core/config.py` |
| **æç¤ºè¯** | `src/prompts/*.yaml` |
| **APIè·¯ç”±** | `src/api/routes/*.py` |
| **æ•°æ®æ¨¡å‹ï¼ˆå°è¯´ï¼‰** | `src/core/schemas_novel/*.py` â­ |
| **æ•°æ®æ¨¡å‹ï¼ˆè„šæœ¬ï¼‰** | `src/core/schemas_script.py` |
| **æ•°æ®æ¨¡å‹ï¼ˆé¡¹ç›®ï¼‰** | `src/core/schemas_project.py` |
| **å·¥å…·å®ç°** | `src/tools/*.py` |
| **å·¥ä½œæµé€»è¾‘** | `src/workflows/*.py` |
| **å‰ç«¯é¡µé¢** | `frontend-new/src/pages/*.tsx` |
| **å‰ç«¯APIå®¢æˆ·ç«¯** | `frontend-new/src/api/*.ts` |

### æƒ³è¦äº†è§£...

| é—®é¢˜ | æŸ¥çœ‹æ–‡æ¡£ |
|------|---------|
| **ç³»ç»Ÿæ¶æ„** | `docs/DEV_STANDARDS.md`, `docs/PROJECT_STRUCTURE.md` (æœ¬æ–‡ä»¶) |
| **ä»£ç è§„èŒƒ** | `docs/DEV_STANDARDS.md` |
| **å·¥å…·åŠŸèƒ½** | `docs/tools/*.md` |
| **å·¥ä½œæµè¯´æ˜** | `docs/workflows/*.md` |
| **APIè§„èŒƒ** | `docs/ui/API_SPECIFICATION.md` |
| **å‰ç«¯æ¶æ„** | `docs/ui/UI_ARCHITECTURE.md` |
| **LLMç³»ç»Ÿ** | `docs/core/DUAL_LLM_SETUP.md`, `docs/core/LLM_INTEGRATION_GUIDE.md` |
| **åŠŸèƒ½ä¼˜åŒ–** | `docs/maintenance/*.md` |

## ğŸ“ å‘½åè§„èŒƒ

### æ–‡ä»¶å‘½å

- **Tools**: `{åŠŸèƒ½}_{æ“ä½œ}.py` (å¦‚ `novel_segmenter.py`)
- **Workflows**: `{åŠŸèƒ½}_workflow.py`
- **Schemas**: `schemas_{category}.py` æˆ– `schemas_{category}/` (ç›®å½•)
- **API Routes**: `{èµ„æº}` æˆ– `{èµ„æº}_v2.py`
- **é…ç½®**: ç»Ÿä¸€åœ¨ `config.py`

### æ–‡æ¡£æ”¾ç½®è§„èŒƒ

ğŸ“ **æ ¹ç›®å½•åº”ä¿æŒç®€æ´ï¼Œæ‰€æœ‰æ–‡æ¡£åº”æ”¾åœ¨ `docs/` ç›®å½•ä¸‹**ï¼š

| æ–‡æ¡£ç±»å‹ | æ”¾ç½®ä½ç½® | ç¤ºä¾‹ | è¯´æ˜ |
|---------|---------|------|------|
| **æ ¸å¿ƒæ–‡æ¡£** | `docs/` | DEV_STANDARDS.md, PROJECT_STRUCTURE.md | æ°¸ä¹…æ€§ã€å…¨å±€æ€§çš„æ–‡æ¡£ |
| **æ¶æ„è®¾è®¡** | `docs/architecture/` | AUTO_PREPROCESS_IMPLEMENTATION.md | ç³»ç»Ÿæ¶æ„å’Œè®¾è®¡æ–‡æ¡£ |
| **æ¨¡å—æ–‡æ¡£** | `docs/{module}/` | docs/tools/README.md | å„æ¨¡å—çš„æŠ€æœ¯å‚è€ƒ |
| **ç»´æŠ¤è®°å½•** | `docs/maintenance/` | DOC_UPDATE_SUMMARY.md | æ¸…ç†æŠ¥å‘Šã€å˜æ›´è®°å½•ã€è¿ç§»æ—¥å¿— |
| **å½’æ¡£æ–‡æ¡£** | `docs/archive/` | v2_architecture/ | æ—§ç‰ˆæœ¬æ–‡æ¡£ |

âš ï¸ **ä¸¥æ ¼ç¦æ­¢**ï¼š
- åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä»»ä½• `.md` æˆ– `.txt` æ–‡æ¡£æ–‡ä»¶ï¼ˆé™¤ README.md, CHANGELOG.mdï¼‰
- åœ¨ `docs/` æ ¹ç›®å½•åˆ›å»ºè¿‡ç¨‹æ€§/æ€»ç»“æ€§æ–‡æ¡£ï¼ˆåº”æ”¾åœ¨ `maintenance/` ä¸‹ï¼‰

### æ•°æ®æ–‡ä»¶

- **æœ€æ–°ç‰ˆæœ¬**: `{name}_latest.json` æˆ– `{name}.json` (æŒ‡é’ˆæ–‡ä»¶)
- **å†å²ç‰ˆæœ¬**: `{name}_v{timestamp}.json`
- **ç¤ºä¾‹**: 
  - `chapter_01.json` (æœ€æ–°ç‰ˆæœ¬)
  - `chapter_01_v20260211_102030.json` (å†å²ç‰ˆæœ¬)

## ğŸš« ä¸åº”æäº¤çš„æ–‡ä»¶

å·²åœ¨ `.gitignore` ä¸­é…ç½®ï¼š

- `.cursor/` - Cursor IDEé…ç½®
- `frontend/` - æ—§ç‰ˆå‰ç«¯ï¼ˆå·²åºŸå¼ƒï¼‰âš ï¸
- `frontend-new/node_modules/` - å‰ç«¯ä¾èµ–
- `__pycache__/` - Pythonç¼“å­˜
- `data/projects/` - é¡¹ç›®æ•°æ®ï¼ˆå¯é€‰æ‹©æ€§æäº¤æµ‹è¯•æ•°æ®ï¼‰
- `output/` - è¿è¡Œè¾“å‡º
- `*.log` - æ—¥å¿—æ–‡ä»¶
- `.env` - ç¯å¢ƒå˜é‡ï¼ˆæ•æ„Ÿä¿¡æ¯ï¼‰
- `.debug/` - è°ƒè¯•æ–‡ä»¶
- `*.png`, `*.jpg` (æ ¹ç›®å½•) - æˆªå›¾åº”æ”¾åœ¨ç‰¹å®šç›®å½•

## ğŸ”„ æ•°æ®æµå‘ï¼ˆPhase I Analyst Workflowï¼‰

### Step 1: Import å¯¼å…¥ä¸æ ‡å‡†åŒ–

```
å¤–éƒ¨ä¸Šä¼ æ–‡ä»¶
    â†“
raw/novel/*.txt
raw/script/*.srt
    â†“ NovelImporter / SrtImporter
analyst/import/novel/novel-imported.md
analyst/import/script/ep01-imported.md
    â†“ NovelMetadataExtractor / NovelChapterDetector
analyst/import/novel/metadata.json
analyst/import/novel/chapters.json
analyst/import/script/episodes.json
```

### Step 2: Script Analysis è„šæœ¬åˆ†æ

```
analyst/import/script/ep01-imported.md (å–æ–‡ä»¶)
    â†“ ScriptSegmenter + HookDetector
analyst/script_analysis/ep01_segmentation_latest.json
analyst/script_analysis/ep01_hook_latest.json
```

### Step 3: Novel Analysis å°è¯´åˆ†æ

```
analyst/import/novel/chapters.json (å–æ–‡ä»¶)
analyst/import/novel/novel-imported.md (å–æ–‡ä»¶)
    â†“ NovelSegmenter (Two-Passå¹¶è¡Œ)
analyst/novel_analysis/chapter_001_segmentation_latest.json
    â†“ NovelAnnotator (Two-Passå¹¶è¡Œ)
analyst/novel_analysis/chapter_001_annotation_latest.json
    â†“ NovelSystemDetector (é€ç« )
analyst/novel_analysis/system_catalog_latest.json
```

### Step 4: Alignment å¯¹é½åˆ†æ

```
analyst/script_analysis/ep01_segmentation_latest.json (å–æ–‡ä»¶)
+
analyst/novel_analysis/chapter_001_annotation_latest.json (å–æ–‡ä»¶)
    â†“ NovelScriptAligner
analyst/alignment/chapter_001_ep01_alignment_latest.json
```

### API-å‰ç«¯äº¤äº’æµç¨‹

```
ç”¨æˆ·æ“ä½œ (frontend-new)
    â†“ API Client (projectsV2.ts)
HTTP Request
    â†“ FastAPI Server (src/api/main.py)
API Routes (routes/projects_v2.py)
    â†“
ImportService (åå°ä»»åŠ¡)
    â†“
Novel/Script Analysis Workflow
    â†“
æ•°æ®ä¿å­˜ (analyst/)
    â†“
API Response
    â†“ React Query (è‡ªåŠ¨åˆ·æ–°)
å‰ç«¯UIæ›´æ–°
```

## ğŸ—ï¸ æ¶æ„åˆ†å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Frontend (React + Vite)         â”‚
â”‚    Pages â†’ Components â†’ API Client      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ HTTP/JSON
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Backend (FastAPI)                â”‚
â”‚    Routes â†’ Services â†’ Workflows        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ Function Call
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Workflows (Orchestration)        â”‚
â”‚    NovelProcessing / ScriptProcessing   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ Tool Call
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Tools (Stateless)                â”‚
â”‚    Importer / Extractor / Segmenter     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ Data Access
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Core (Schemas + Managers)        â”‚
â”‚    Schemas / ProjectManager / Config    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ File I/O
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Data Storage                     â”‚
â”‚    data/projects/ (JSON Files)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**æœ€åæ›´æ–°**: 2026-02-13  
**ç»´æŠ¤è€…**: Project Team  
**æ›´æ–°å†…å®¹**: 
- æ•°æ®å­˜å‚¨ç»Ÿä¸€åˆ° `analyst/` ç›®å½•
- `raw/srt/` æ”¹åä¸º `raw/script/`
- å»é™¤ `processed/` å’Œé¡¶å±‚ `alignment/` æ–‡ä»¶å¤¹
- é‡‡ç”¨å››æ­¥å·¥ä½œæµ: import â†’ script_analysis â†’ novel_analysis â†’ alignment
