# history/ ç›®å½•å¤„ç†é”™è¯¯ä¸çº æ­£

**é”™è¯¯å‘ç°æ—¶é—´**: 2026-02-05  
**ä¸¥é‡çº§åˆ«**: âš ï¸ é«˜ï¼ˆå½±å“ç³»ç»Ÿç‰ˆæœ¬ç®¡ç†æœºåˆ¶ï¼‰

---

## âŒ é”™è¯¯æè¿°

åœ¨V4.0æ¸…ç†è¿‡ç¨‹ä¸­ï¼Œæˆ‘**é”™è¯¯åœ°å°†`history/`ç›®å½•å½’æ¡£**åˆ°äº†`archive/v2_deprecated/`ã€‚

### ä¸ºä»€ä¹ˆè¿™æ˜¯é”™è¯¯çš„ï¼Ÿ

æ ¹æ® `src/core/artifact_manager.py` çš„è®¾è®¡ï¼š

```python
class ArtifactManager:
    """
    Manages versioned data artifacts (Analysis, Alignment, etc.)
    Strategy: "Latest Pointer + Timestamped Versions"
    """
    
    @staticmethod
    def save_artifact(...):
        """
        ç­–ç•¥ï¼š
        1. ä¸»ç›®å½•åªä¿ç•™ latest æ–‡ä»¶
        2. æ‰€æœ‰ç‰ˆæœ¬æ–‡ä»¶ï¼ˆåŒ…æ‹¬æ–°ç‰ˆæœ¬ï¼‰ä¿å­˜åœ¨ history/ ç›®å½•
        """
        # history ç›®å½•ï¼šæ‰€æœ‰ç‰ˆæœ¬æ–‡ä»¶
        history_dir = os.path.join(base_dir, "history")
        
        # 0. ç¡®ä¿ history ç›®å½•å­˜åœ¨
        os.makedirs(history_dir, exist_ok=True)
```

**`history/` ç›®å½•æ˜¯ç³»ç»Ÿç‰ˆæœ¬ç®¡ç†çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼**

---

## âœ… æ­£ç¡®çš„å¤„ç†æ–¹å¼

### ç›®å½•åˆ†ç±»

| ç›®å½• | æ€§è´¨ | æ­£ç¡®å¤„ç† | åŸå›  |
|------|------|----------|------|
| `history/` | **ç³»ç»Ÿç›®å½•** | âœ… **å¿…é¡»ä¿ç•™** | ArtifactManagerç”¨äºç‰ˆæœ¬ç®¡ç† |
| `_backup/` | æ—§å¤‡ä»½ | âœ… å¯å½’æ¡£ | V2.0äº§ç”Ÿçš„å¤‡ä»½ï¼Œéç³»ç»Ÿæœºåˆ¶ |
| `versions/` | ç©ºç›®å½• | âœ… å¯åˆ é™¤ | æœªä½¿ç”¨ |
| `tools/` | ç©ºç›®å½• | âœ… å¯åˆ é™¤ | æœªä½¿ç”¨ |

---

## ğŸ”§ å·²æ‰§è¡Œçš„çº æ­£æªæ–½

### 1. æ¢å¤ history/ ç›®å½•ç»“æ„

```bash
# ä¸ºV4.0é‡æ–°åˆ›å»ºç©ºçš„historyç›®å½•
mkdir -p data/projects/PROJ_002/alignment/history/

âœ… V4.0ç°åœ¨å¯ä»¥æ­£å¸¸ä½¿ç”¨ç‰ˆæœ¬ç®¡ç†æœºåˆ¶
```

### 2. V2.0å†å²æ–‡ä»¶å¤„ç†

```bash
âœ… V2.0äº§ç”Ÿçš„21ä¸ªå†å²æ–‡ä»¶ä¿ç•™åœ¨å½’æ¡£ä¸­
   ä½ç½®: archive/v2_deprecated/alignment_data/history/
   
è¿™äº›æ˜¯V2.0çš„æ—§ç‰ˆæœ¬æ–‡ä»¶ï¼Œä¸å½±å“V4.0ä½¿ç”¨
```

---

## ğŸ“Š æœ€ç»ˆæ­£ç¡®çš„ç›®å½•ç»“æ„

### alignment/ ç›®å½•ï¼ˆV4.0ï¼‰

```
data/projects/PROJ_002/alignment/
â”œâ”€â”€ ep01_body_alignment.json          â† V4.0æ•°æ®ï¼ˆlatestï¼‰
â””â”€â”€ history/                          â† ç‰ˆæœ¬ç®¡ç†ç›®å½•ï¼ˆç³»ç»Ÿå¿…éœ€ï¼‰âœ¨
    â””â”€â”€ (V4.0è¿è¡Œåä¼šè‡ªåŠ¨ä¿å­˜ç‰ˆæœ¬æ–‡ä»¶)
```

### archive/ ç›®å½•

```
archive/v2_deprecated/
â”œâ”€â”€ workflows/              7ä¸ªæ–‡ä»¶
â”œâ”€â”€ alignment_modules/      3ä¸ªæ–‡ä»¶
â””â”€â”€ alignment_data/        52ä¸ªæ–‡ä»¶
    â”œâ”€â”€ v2æ•°æ®æ–‡ä»¶        15ä¸ª â† V2.0ç”Ÿæˆçš„latestæ–‡ä»¶
    â”œâ”€â”€ _backup/          16ä¸ª â† V2.0çš„å¤‡ä»½
    â””â”€â”€ history/          21ä¸ª â† V2.0çš„å†å²ç‰ˆæœ¬ï¼ˆå·²å½’æ¡£ï¼‰
```

---

## ğŸ“‹ ç‰ˆæœ¬ç®¡ç†æœºåˆ¶è¯´æ˜

### ArtifactManager å·¥ä½œæµç¨‹

```python
# ä¿å­˜æ–°æ–‡ä»¶æ—¶:
1. æ£€æŸ¥å¹¶åˆ›å»º history/ ç›®å½•
2. å°†ä¸»ç›®å½•çš„æ—§ç‰ˆæœ¬æ–‡ä»¶ç§»åŠ¨åˆ° history/
3. ä¿å­˜æ–°ç‰ˆæœ¬åˆ° history/artifact_v20260205_001234.json
4. æ›´æ–°ä¸»ç›®å½•çš„ artifact_latest.json
```

### ç›®å½•ä½œç”¨

```
ä¸»ç›®å½• (alignment/)
â”œâ”€â”€ *_latest.json         â† æŒ‡å‘æœ€æ–°ç‰ˆæœ¬ï¼ˆä¾›ç³»ç»Ÿè¯»å–ï¼‰
â””â”€â”€ history/
    â”œâ”€â”€ *_v20260204_123456.json
    â”œâ”€â”€ *_v20260204_150000.json
    â””â”€â”€ *_v20260205_001234.json   â† æ‰€æœ‰å†å²ç‰ˆæœ¬
```

**ä¼˜ç‚¹**ï¼š
- âœ… ä¸»ç›®å½•æ¸…çˆ½ï¼Œåªæœ‰latestæ–‡ä»¶
- âœ… å®Œæ•´ä¿ç•™ç‰ˆæœ¬å†å²
- âœ… å¯éšæ—¶å›æ»šåˆ°ä»»æ„ç‰ˆæœ¬
- âœ… è‡ªåŠ¨åŒ–ç®¡ç†ï¼Œæ— éœ€æ‰‹åŠ¨å¹²é¢„

---

## ğŸ“ ç»éªŒæ•™è®­

### 1. æ¸…ç†å‰å¿…é¡»æ£€æŸ¥

åœ¨å½’æ¡£/åˆ é™¤ä»»ä½•ç›®å½•å‰ï¼Œå¿…é¡»ï¼š
- âœ… æ£€æŸ¥ä»£ç ä¸­æ˜¯å¦æœ‰å¼•ç”¨
- âœ… æ£€æŸ¥æ˜¯å¦æ˜¯ç³»ç»Ÿæœºåˆ¶çš„ä¸€éƒ¨åˆ†
- âœ… åŒºåˆ†"æ—§æ•°æ®"ä¸"ç³»ç»Ÿç›®å½•"

### 2. ç›®å½•å‘½åçš„æ­§ä¹‰

`history/` è¿™ä¸ªåå­—å¯èƒ½è®©äººè¯¯ä»¥ä¸ºæ˜¯"å†å²æ—§æ–‡ä»¶"ï¼Œä½†å®é™…ä¸Šæ˜¯ï¼š
- âŒ ä¸æ˜¯"åºŸå¼ƒçš„æ—§æ–‡ä»¶"
- âœ… æ˜¯"ç‰ˆæœ¬ç®¡ç†æœºåˆ¶"

**å»ºè®®**: æœªæ¥å¯è€ƒè™‘æ›´æ˜ç¡®çš„å‘½åï¼Œå¦‚ `versions/` æˆ– `version_history/`

### 3. æ–‡æ¡£çš„é‡è¦æ€§

è¿™æ¬¡é”™è¯¯æš´éœ²äº†ï¼š
- âš ï¸ ç³»ç»Ÿæ¶æ„æ–‡æ¡£ä¸­æœªæ˜ç¡®è¯´æ˜`history/`ç›®å½•çš„ä½œç”¨
- âš ï¸ `artifact_manager.py`çš„docstringåº”è¯¥æ›´æ˜æ˜¾

---

## âœ… å½“å‰çŠ¶æ€

**é—®é¢˜**: âœ… å·²ä¿®å¤  
**ç³»ç»ŸåŠŸèƒ½**: âœ… æ­£å¸¸  
**æ•°æ®å®Œæ•´æ€§**: âœ… æ— æŸå¤±

**ä¸‹æ¬¡V4.0è¿è¡Œæ—¶**ï¼Œ`artifact_manager.py`ä¼šè‡ªåŠ¨ï¼š
1. æ£€æµ‹åˆ° history/ ç›®å½•å·²å­˜åœ¨
2. æ­£å¸¸ä¿å­˜ç‰ˆæœ¬æ–‡ä»¶åˆ° history/
3. æ›´æ–° latest æŒ‡é’ˆ

---

## ğŸ“ TODO

- [ ] æ›´æ–° `docs/architecture/logic_flows.md`ï¼Œæ˜ç¡®è¯´æ˜ history/ ç›®å½•çš„ä½œç”¨
- [ ] åœ¨ `artifact_manager.py` ä¸­æ·»åŠ æ›´æ˜æ˜¾çš„æ³¨é‡Š
- [ ] è€ƒè™‘åœ¨ history/ ç›®å½•ä¸­æ·»åŠ  README.md è¯´æ˜å…¶ç”¨é€”

---

**çº æ­£æ—¶é—´**: 2026-02-05  
**çº æ­£æ–¹å¼**: é‡æ–°åˆ›å»ºç©ºçš„ history/ ç›®å½•ä¾›V4.0ä½¿ç”¨  
**æ–‡æ¡£çŠ¶æ€**: âœ… å®Œæˆ
